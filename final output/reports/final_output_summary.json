{"meta":{"script":"run_step2_step3_final.py","script_version":"1.6.0","generated_utc":"2026-02-25T00:28:15.110102+00:00","start_capital":10000.0,"pair_tag":"spy_qqq","display_symbols":["SPY","QQQ"],"clean_final_dir":true,"prune_step3_temp":true},"paths":{"final_root":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output","step2_dir":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\step2","step3_dir":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\step3","dual_ml_dir":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\dual ml","charts_dir":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\charts","reports_dir":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\reports","step2_chart":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\charts\\01_step2_ml_simulation_spy_qqq.png","step3_chart":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\final output\\charts\\02_step3_real_ml_spy_qqq.png"},"snapshots":{"step2_ml_simulation":{"avg_monthly_pnl":41.928061,"median_monthly_pnl":4.31112,"avg_monthly_trades":6.557377,"positive_month_rate":0.516393,"end_equity":15115.223499,"cagr":0.041925,"max_drawdown":0.108398,"calmar":0.386769,"total_trades":0},"step3_real_ml":{"avg_monthly_pnl":74.180121,"median_monthly_pnl":37.42478,"avg_monthly_trades":7.134021,"positive_month_rate":0.556701,"end_equity":17195.471708,"cagr":0.069418,"max_drawdown":0.120407,"calmar":0.576529,"total_trades":692,"stress_1_25_avg_monthly_pnl":59.106127,"stress_1_50_avg_monthly_pnl":45.314021,"bootstrap_p10_avg_monthly_pnl":30.867095},"step3_active_meta":{"script":"step3_train_and_backtest.py","script_version":"2.6.0","generated_utc":"2026-02-25T00:28:13.326840+00:00","display_symbol_1":"QQQ","display_symbol_2":"SPY","train_lookback_days":1460,"embargo_days":10,"min_train_events":220,"min_val_events":45,"min_test_events":6,"mix_struct_weight":0.55,"policy_profile":"growth","max_aggressive_size":1.35,"portfolio_allocator":"dynamic_regime","portfolio_objective":"end_equity","portfolio_train_ratio":0.55,"portfolio_weight_step":0.05,"portfolio_lookback_days":504,"portfolio_min_train_days":252,"portfolio_turnover_penalty":0.04,"portfolio_weight_smoothing":0.15,"portfolio_momentum_days":63,"portfolio_vol_days":21,"portfolio_vol_penalty":1.4,"portfolio_max_tilt":0.2,"portfolio_min_weight":0.25,"portfolio_max_weight":0.98,"portfolio_spy_guard_enabled":true,"portfolio_spy_guard_lookback_days":63,"portfolio_spy_guard_drift_lookback_days":42,"portfolio_spy_guard_min_mult":0.25,"portfolio_spy_guard_dd_penalty":1.2,"spy_drift_kill_switch":"soft","spy_drift_feature_z_cap":1.25,"drought_relief_enable":true,"drought_relief_symbol":"QQQ","drought_target_trades_per_month":5.5,"drought_p_cut_relax":0.015,"drought_ev_relax":0.00018,"drought_size_boost":0.08,"pattern_aid_enable":false,"pattern_n_clusters":6,"pattern_min_cluster_samples":40,"pattern_prior_strength":120.0,"pattern_consistency_tol":0.004,"pattern_prob_strength":0.55,"pattern_ret_strength":0.65,"pattern_prob_max_abs_delta":0.04,"pattern_ret_max_abs_delta":0.0035,"exclude_leaky_features":false,"regime_model_enable":false,"regime_lookahead_events":18,"regime_label_quantile":0.55,"regime_min_train_samples":160,"regime_p_cut":0.52,"regime_agg_p_cut":0.62,"regime_ev_scale":0.8,"regime_size_scale":0.3,"regime_size_min_mult":0.6,"regime_size_max_mult":1.2,"tail_q10_cut":-0.02,"tail_agg_q10_cut":-0.02,"cost_stress_multipliers":[1.25,1.5],"bootstrap_samples":800,"bootstrap_block_months":6,"bootstrap_seed":42,"retune_every_folds":2,"model_stack":"LightGBM classifier/regressor/quantiles + ridge ensemble + calibrated probabilities + confidence sizing + q10 tail gate","note":"Nested walk-forward tuning with time+label_end purge/embargo, drift-aware safety guard, and monthly out-of-sample testing."},"step3_optimization_best":{"run_id":2,"name":"ultimate_high_gain_guarded_soft","config":{"name":"ultimate_high_gain_guarded_soft","train_lookback_days":1460,"embargo_days":10,"min_train_events":220,"min_val_events":45,"min_test_events":6,"mix_struct_weight":0.55,"policy_profile":"growth","max_aggressive_size":1.35,"portfolio_allocator":"dynamic_regime","retune_every_folds":2,"portfolio_objective":"end_equity","portfolio_train_ratio":0.55,"portfolio_lookback_days":504,"portfolio_weight_smoothing":0.15,"portfolio_min_weight":0.25,"portfolio_max_weight":0.98,"spy_drift_kill_switch":"soft","spy_drift_feature_z_cap":1.25,"drought_relief_enable":true,"drought_relief_symbol":"QQQ","drought_target_trades_per_month":5.5,"drought_p_cut_relax":0.015,"drought_ev_relax":0.00018,"drought_size_boost":0.08,"portfolio_spy_guard_lookback_days":63,"portfolio_spy_guard_drift_lookback_days":42,"portfolio_spy_guard_min_mult":0.25,"portfolio_spy_guard_dd_penalty":1.2},"status":"ok","error":null,"objective_score":9.425812,"robustness":{"pass":false,"failures":["spy p25_calmar -7.6691 < -7.0000","avg_monthly_pnl 74.18 < 80.00"],"snapshot":{"max_drawdown":0.120407,"avg_monthly_pnl":74.180121,"monthly_positive_rate":0.556701,"top5_positive_pnl_share":0.267095,"zero_trade_month_rate":0.113402,"qqq_negative_fold_rate":0.506329,"spy_negative_fold_rate":0.743902,"qqq_p25_test_calmar":-4.747485,"spy_p25_test_calmar":-7.669097,"stress_1.25_avg_monthly_pnl":59.106127,"stress_1.25_max_drawdown":0.126651,"stress_1.50_avg_monthly_pnl":45.314021,"bootstrap_p10_avg_monthly_pnl":30.867095}},"summary_path":"C:\\dev\\Coding\\Trader\\adaptive-systematic-trading\\step3_out\\optimization\\runs\\02_ultimate_high_gain_guarded_soft\\backtest\\step3_summary.json","portfolio_snapshot":{"dual_perf":{"start_time_utc":"2017-12-01 00:00:00+00:00","end_time_utc":"2025-12-29 00:00:00+00:00","end_equity":17195.471708,"cagr":0.069418,"max_drawdown":0.120407,"calmar":0.576529,"n_days":2951},"qqq_standalone_perf":{"start_time_utc":"2017-12-01 00:00:00+00:00","end_time_utc":"2025-12-29 00:00:00+00:00","end_equity":17312.004355,"cagr":0.070313,"max_drawdown":0.122298,"calmar":0.574927,"n_days":2951},"spy_standalone_perf":{"start_time_utc":"2017-12-01 00:00:00+00:00","end_time_utc":"2025-12-29 00:00:00+00:00","end_equity":13169.130134,"cagr":0.034672,"max_drawdown":0.075734,"calmar":0.457813,"n_days":2951},"allocator":{"selected":"static_train_optimized","holdout_split_index":1623,"holdout_start_utc":"2022-05-12 00:00:00+00:00","holdout_score_static":1.039511,"holdout_score_dynamic":0.969571,"qqq_weight_mean":0.972735,"qqq_weight_min":0.957716,"qqq_weight_max":0.987112,"qqq_weight_turnover_abs":0.909701,"spy_weight_mean_pre_guard":0.05,"spy_guard_mean":0.545297,"spy_guard_min":0.257769,"spy_guard_max":0.845686},"avg_monthly_pnl":74.180121,"median_monthly_pnl":37.42478,"avg_monthly_trades":7.134021,"monthly_positive_rate":0.556701,"monthly_negative_rate":0.329897,"top5_positive_pnl_share":0.267095,"zero_trade_month_rate":0.113402,"total_trades":692,"aggressive_trade_rate":0.547688,"best_month":{"month_end":"2020-07-31 00:00:00+00:00","pnl":968.733261,"ret":0.074326,"trades":9.0},"worst_month":{"month_end":"2025-01-31 00:00:00+00:00","pnl":-731.533038,"ret":-0.043362,"trades":6.0},"best_day":{"date_utc":"2021-03-16 00:00:00+00:00","pnl":552.720598},"worst_day":{"date_utc":"2022-07-13 00:00:00+00:00","pnl":-534.729421},"cost_stress_tests":[{"cost_multiplier":1.25,"dual_perf":{"start_time_utc":"2017-12-01 00:00:00+00:00","end_time_utc":"2025-12-29 00:00:00+00:00","end_equity":15733.294319,"cagr":0.057716,"max_drawdown":0.126651,"calmar":0.455707,"n_days":2951},"avg_monthly_pnl":59.106127,"median_monthly_pnl":24.126062,"monthly_positive_rate":0.556701},{"cost_multiplier":1.5,"dual_perf":{"start_time_utc":"2017-12-01 00:00:00+00:00","end_time_utc":"2025-12-29 00:00:00+00:00","end_equity":14395.460048,"cagr":0.046142,"max_drawdown":0.132851,"calmar":0.347318,"n_days":2951},"avg_monthly_pnl":45.314021,"median_monthly_pnl":4.95895,"monthly_positive_rate":0.546392}],"bootstrap":{"enabled":true,"n_samples":800,"block_months":6,"seed":42,"avg_monthly_pnl":{"p05":18.542299,"p10":30.867095,"p50":72.897264,"p90":122.899489,"p95":134.30323,"mean":75.043255},"median_monthly_pnl":{"p05":0.0,"p10":0.0,"p50":37.42478,"p90":78.429414,"p95":96.978047,"mean":37.155984},"monthly_positive_rate":{"p05":0.463918,"p10":0.484536,"p50":0.556701,"p90":0.628866,"p95":0.649485,"mean":0.558466},"end_equity":{"p05":11601.828643,"p10":12693.845964,"p50":17015.520809,"p90":24560.239713,"p95":26569.405848,"mean":17913.904141},"max_drawdown":{"p05":0.047505,"p10":0.053987,"p50":0.088016,"p90":0.147914,"p95":0.170536,"mean":0.096058},"calmar":{"p05":0.128165,"p10":0.226389,"p50":0.744398,"p90":1.862472,"p95":2.207393,"mean":0.94406}}}},"pattern_ml_decision":null}}