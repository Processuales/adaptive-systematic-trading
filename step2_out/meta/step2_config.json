{
  "script": "step2_build_events_dataset.py",
  "version": "2.1.0",
  "trade_symbol": "QQQ",
  "symbols_loaded": [
    "SPY",
    "QQQ"
  ],
  "knobs": {
    "trend_fast_span": 12,
    "trend_slow_span": 48,
    "trend_in": 0.6,
    "pullback_z": 1.0,
    "trend_regime_min": 0.25,
    "min_event_spacing_bars": 1,
    "ewma_var_alpha": 0.06,
    "atr_span": 14,
    "horizon_intra": 12,
    "horizon_overn": 10,
    "tp_mult_intra": 2.0,
    "sl_mult_intra": 1.5,
    "tp_mult_overn": 2.2,
    "sl_mult_overn": 1.6,
    "same_bar_policy": "worst",
    "spread_half_bps": {
      "SPY": 0.8,
      "QQQ": 1.2,
      "SMH": 1.8
    },
    "slip_base_bps": 0.8,
    "slip_vol_mult": 0.05,
    "slip_spike_add_bps": 2.0,
    "vol_spike_q": 0.9,
    "overnight_slip_add_bps": 1.5,
    "commission_round_trip_bps": 1.0,
    "gap_lookback_events": 120,
    "gap_tail_k": 2.0,
    "sigma_rank_window": 500,
    "atr_rank_window": 500,
    "rank_min_periods": 200,
    "intraday_tail_window": 200,
    "intraday_tail_min_periods": 50,
    "intraday_tail_z": 2.0,
    "include_cross_asset": true,
    "cross_symbol": "SPY",
    "cross_merge_tolerance": "30min",
    "dropna_core_only": true
  },
  "notes": {
    "barrier_touch": "High/Low touch detection; exit at next open; same-bar policy configurable",
    "gap_features": "Rolling stats computed over gap events only, shifted by 1 event to prevent leakage",
    "cross_asset": "Optional SPY context merged via merge_asof with tolerance; event-level mapping via t_idx",
    "nan_policy": "Drops rows only when core features are missing (recommended)"
  },
  "outputs": {
    "bar_features_dir": "C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\bar_features",
    "events_path": "C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\events\\qqq_events.parquet"
  },
  "events_summary": {
    "n_events": 10019,
    "families": {
      "trend_long": 9880,
      "pullback_long": 139
    },
    "exit_reasons": {
      "sl": 4640,
      "tp": 3899,
      "horizon": 1480
    },
    "y_rate": 0.48937019662640985,
    "net_mean_bps": -2.2560860853304425,
    "gross_mean_bps": 6.885347272143061,
    "cost_mean_bps": 9.141433357473502,
    "overnight_rate": 0.14292843597165386,
    "same_bar_ambiguous_rate": 0.0006986725222078052,
    "tp_to_cost_median": 9.490995079464808,
    "weekly_events_mean": 19.120229007633586,
    "weekly_events_p90": 35.0
  }
}