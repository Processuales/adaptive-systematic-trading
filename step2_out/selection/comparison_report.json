{"meta":{"script":"step2_compare_and_select.py","script_version":"1.0.0","generated_utc":"2026-02-15T06:55:53.682889+00:00","n_scenarios":4,"n_trials_per_scenario":20,"seed":42,"filters_override":null},"scenario_summaries":[{"scenario":"qqq_cross_off","include_cross":false,"trade_symbol":"QQQ","cross_symbol":"SPY","meta":{"script_version":"1.0.0","generated_utc":"2026-02-15T06:43:39.566777+00:00","n_trials_requested":20,"n_trials_valid":14,"n_trials_ml_valid":8,"trade_symbol":"QQQ","symbols":["SPY","QQQ"],"cross_symbol":"SPY","include_cross":false,"split_policy":"80/20 chronological by bar index; train uses label_end_idx < split, test uses t_idx >= split"},"best_no_ml_test":{"n":34,"y_rate":0.441176,"net_bps_mean":12.111731,"net_bps_med":-9.279242,"cum_logret":0.04118,"end_equity":10420.39537,"max_drawdown":0.027421,"cagr":0.023926},"best_no_ml_filter":"no_overnight_sigma_50_85_trend_decile_4_6","best_ml_test":{"n":38,"y_rate":0.631579,"net_bps_mean":27.110819,"net_bps_med":40.378198,"cum_logret":0.103021,"end_equity":11085.148131,"max_drawdown":0.033473,"cagr":0.054352},"best_ml_filter":"no_overnight_sigma_50_85"},{"scenario":"qqq_cross_on","include_cross":true,"trade_symbol":"QQQ","cross_symbol":"SPY","meta":{"script_version":"1.0.0","generated_utc":"2026-02-15T06:47:55.987946+00:00","n_trials_requested":20,"n_trials_valid":14,"n_trials_ml_valid":9,"trade_symbol":"QQQ","symbols":["SPY","QQQ"],"cross_symbol":"SPY","include_cross":true,"split_policy":"80/20 chronological by bar index; train uses label_end_idx < split, test uses t_idx >= split"},"best_no_ml_test":{"n":34,"y_rate":0.441176,"net_bps_mean":12.111731,"net_bps_med":-9.279242,"cum_logret":0.04118,"end_equity":10420.39537,"max_drawdown":0.027421,"cagr":0.023926},"best_no_ml_filter":"no_overnight_sigma_50_85_trend_decile_4_6","best_ml_test":{"n":25,"y_rate":0.6,"net_bps_mean":23.173677,"net_bps_med":49.143182,"cum_logret":0.057934,"end_equity":10596.452614,"max_drawdown":0.023097,"cagr":0.032726},"best_ml_filter":"no_overnight_sigma_50_85"},{"scenario":"spy_cross_off","include_cross":false,"trade_symbol":"SPY","cross_symbol":"QQQ","meta":{"script_version":"1.0.0","generated_utc":"2026-02-15T06:51:23.031076+00:00","n_trials_requested":20,"n_trials_valid":13,"n_trials_ml_valid":7,"trade_symbol":"SPY","symbols":["SPY","QQQ"],"cross_symbol":"QQQ","include_cross":false,"split_policy":"80/20 chronological by bar index; train uses label_end_idx < split, test uses t_idx >= split"},"best_no_ml_test":{"n":33,"y_rate":0.515152,"net_bps_mean":11.33888,"net_bps_med":15.186738,"cum_logret":0.037418,"end_equity":10381.271831,"max_drawdown":0.027681,"cagr":0.019162},"best_no_ml_filter":"no_overnight_sigma_50_85_trend_0p3_1p0","best_ml_test":{"n":34,"y_rate":0.558824,"net_bps_mean":24.07619,"net_bps_med":8.448818,"cum_logret":0.081859,"end_equity":10853.02821,"max_drawdown":0.021352,"cagr":0.04229},"best_ml_filter":"no_overnight_sigma_50_85"},{"scenario":"spy_cross_on","include_cross":true,"trade_symbol":"SPY","cross_symbol":"QQQ","meta":{"script_version":"1.0.0","generated_utc":"2026-02-15T06:55:53.366342+00:00","n_trials_requested":20,"n_trials_valid":13,"n_trials_ml_valid":7,"trade_symbol":"SPY","symbols":["SPY","QQQ"],"cross_symbol":"QQQ","include_cross":true,"split_policy":"80/20 chronological by bar index; train uses label_end_idx < split, test uses t_idx >= split"},"best_no_ml_test":{"n":33,"y_rate":0.515152,"net_bps_mean":11.33888,"net_bps_med":15.186738,"cum_logret":0.037418,"end_equity":10381.271831,"max_drawdown":0.027681,"cagr":0.019162},"best_no_ml_filter":"no_overnight_sigma_50_85_trend_0p3_1p0","best_ml_test":{"n":35,"y_rate":0.542857,"net_bps_mean":13.849539,"net_bps_med":12.786219,"cum_logret":0.048473,"end_equity":10496.674345,"max_drawdown":0.024831,"cagr":0.02459},"best_ml_filter":"no_overnight_sigma_55_90"}],"best_candidates":{"non_ml_by_end_equity":{"mode":"no_ml","selected_by":"end_equity","scenario":{"name":"qqq_cross_off","symbols":["SPY","QQQ"],"trade_symbol":"QQQ","cross_symbol":"SPY","include_cross":false},"summary_path":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\selection\\qqq_cross_off\\step2b_summary.json","trial":{"filter_name":"no_overnight_sigma_50_85_trend_decile_4_6","knobs":{"trend_fast_span":8,"trend_slow_span":40,"trend_in":1.105922,"pullback_z":0.876791,"trend_regime_min":0.289646,"min_event_spacing_bars":1,"ewma_var_alpha":0.086644,"atr_span":14,"horizon_intra":16,"horizon_overn":10,"tp_mult_intra":1.801457,"sl_mult_intra":1.013936,"tp_mult_overn":1.916285,"sl_mult_overn":1.066665,"same_bar_policy":"worst","spread_half_bps":{"SPY":0.8,"QQQ":1.2,"SMH":1.8},"slip_base_bps":0.8,"slip_vol_mult":0.05,"slip_spike_add_bps":2.0,"vol_spike_q":0.9,"overnight_slip_add_bps":1.5,"commission_round_trip_bps":1.0,"gap_lookback_events":120,"gap_tail_k":2.0,"sigma_rank_window":500,"atr_rank_window":500,"rank_min_periods":200,"intraday_tail_window":200,"intraday_tail_min_periods":50,"intraday_tail_z":2.0,"include_cross_asset":false,"cross_symbol":"SPY","cross_merge_tolerance":"30min","dropna_core_only":true},"n_bars":17626,"split_bar_idx":14100,"split_time_utc":"2024-02-06 19:00:00+00:00","base_counts":{"all_events":8568,"filtered_events":507,"train_filtered":397,"test_filtered":110},"no_ml":{"train":{"n":113,"y_rate":0.575221,"net_bps_mean":12.951226,"net_bps_med":29.842565,"cum_logret":0.146349,"end_equity":11575.999537,"max_drawdown":0.049595,"cagr":0.01919},"test":{"n":34,"y_rate":0.441176,"net_bps_mean":12.111731,"net_bps_med":-9.279242,"cum_logret":0.04118,"end_equity":10420.39537,"max_drawdown":0.027421,"cagr":0.023926},"score":10101.075962},"ml_sim":{"model_features":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","gap_tail","vol_z","dist_to_hi","range_ratio","tp_to_cost","entry_overnight"],"p_cut":0.563876,"edge_cut":0.001534,"valid":false,"train":{"n":0,"y_rate":null,"net_bps_mean":null,"net_bps_med":null,"cum_logret":null,"end_equity":10000.0,"max_drawdown":null,"cagr":null},"test":{"n":0,"y_rate":null,"net_bps_mean":null,"net_bps_med":null,"cum_logret":null,"end_equity":10000.0,"max_drawdown":null,"cagr":null},"score":-1e+18},"trial":18},"test_snapshot":{"n":34,"end_equity":10420.39537,"cagr":0.023926,"max_drawdown":0.027421,"calmar":0.872543,"net_bps_mean":12.111731}},"non_ml_by_calmar":{"mode":"no_ml","selected_by":"end_equity","scenario":{"name":"qqq_cross_off","symbols":["SPY","QQQ"],"trade_symbol":"QQQ","cross_symbol":"SPY","include_cross":false},"summary_path":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\selection\\qqq_cross_off\\step2b_summary.json","trial":{"filter_name":"no_overnight_sigma_50_85_trend_decile_4_6","knobs":{"trend_fast_span":8,"trend_slow_span":40,"trend_in":1.105922,"pullback_z":0.876791,"trend_regime_min":0.289646,"min_event_spacing_bars":1,"ewma_var_alpha":0.086644,"atr_span":14,"horizon_intra":16,"horizon_overn":10,"tp_mult_intra":1.801457,"sl_mult_intra":1.013936,"tp_mult_overn":1.916285,"sl_mult_overn":1.066665,"same_bar_policy":"worst","spread_half_bps":{"SPY":0.8,"QQQ":1.2,"SMH":1.8},"slip_base_bps":0.8,"slip_vol_mult":0.05,"slip_spike_add_bps":2.0,"vol_spike_q":0.9,"overnight_slip_add_bps":1.5,"commission_round_trip_bps":1.0,"gap_lookback_events":120,"gap_tail_k":2.0,"sigma_rank_window":500,"atr_rank_window":500,"rank_min_periods":200,"intraday_tail_window":200,"intraday_tail_min_periods":50,"intraday_tail_z":2.0,"include_cross_asset":false,"cross_symbol":"SPY","cross_merge_tolerance":"30min","dropna_core_only":true},"n_bars":17626,"split_bar_idx":14100,"split_time_utc":"2024-02-06 19:00:00+00:00","base_counts":{"all_events":8568,"filtered_events":507,"train_filtered":397,"test_filtered":110},"no_ml":{"train":{"n":113,"y_rate":0.575221,"net_bps_mean":12.951226,"net_bps_med":29.842565,"cum_logret":0.146349,"end_equity":11575.999537,"max_drawdown":0.049595,"cagr":0.01919},"test":{"n":34,"y_rate":0.441176,"net_bps_mean":12.111731,"net_bps_med":-9.279242,"cum_logret":0.04118,"end_equity":10420.39537,"max_drawdown":0.027421,"cagr":0.023926},"score":10101.075962},"ml_sim":{"model_features":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","gap_tail","vol_z","dist_to_hi","range_ratio","tp_to_cost","entry_overnight"],"p_cut":0.563876,"edge_cut":0.001534,"valid":false,"train":{"n":0,"y_rate":null,"net_bps_mean":null,"net_bps_med":null,"cum_logret":null,"end_equity":10000.0,"max_drawdown":null,"cagr":null},"test":{"n":0,"y_rate":null,"net_bps_mean":null,"net_bps_med":null,"cum_logret":null,"end_equity":10000.0,"max_drawdown":null,"cagr":null},"score":-1e+18},"trial":18},"test_snapshot":{"n":34,"end_equity":10420.39537,"cagr":0.023926,"max_drawdown":0.027421,"calmar":0.872543,"net_bps_mean":12.111731}},"ml_by_end_equity":{"mode":"ml_sim","selected_by":"end_equity","scenario":{"name":"qqq_cross_off","symbols":["SPY","QQQ"],"trade_symbol":"QQQ","cross_symbol":"SPY","include_cross":false},"summary_path":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\selection\\qqq_cross_off\\step2b_summary.json","trial":{"filter_name":"no_overnight_sigma_50_85","knobs":{"trend_fast_span":12,"trend_slow_span":56,"trend_in":0.512047,"pullback_z":1.137992,"trend_regime_min":0.370818,"min_event_spacing_bars":1,"ewma_var_alpha":0.074304,"atr_span":24,"horizon_intra":12,"horizon_overn":10,"tp_mult_intra":1.973766,"sl_mult_intra":1.331569,"tp_mult_overn":2.234102,"sl_mult_overn":1.507134,"same_bar_policy":"worst","spread_half_bps":{"SPY":0.8,"QQQ":1.2,"SMH":1.8},"slip_base_bps":0.8,"slip_vol_mult":0.05,"slip_spike_add_bps":2.0,"vol_spike_q":0.9,"overnight_slip_add_bps":1.5,"commission_round_trip_bps":1.0,"gap_lookback_events":120,"gap_tail_k":2.0,"sigma_rank_window":500,"atr_rank_window":500,"rank_min_periods":200,"intraday_tail_window":200,"intraday_tail_min_periods":50,"intraday_tail_z":2.0,"include_cross_asset":false,"cross_symbol":"SPY","cross_merge_tolerance":"30min","dropna_core_only":true},"n_bars":17626,"split_bar_idx":14100,"split_time_utc":"2024-02-06 19:00:00+00:00","base_counts":{"all_events":10519,"filtered_events":2167,"train_filtered":1702,"test_filtered":464},"no_ml":{"train":{"n":335,"y_rate":0.486567,"net_bps_mean":2.603254,"net_bps_med":-10.078431,"cum_logret":0.087209,"end_equity":10911.247281,"max_drawdown":0.202304,"cagr":0.011105},"test":{"n":91,"y_rate":0.483516,"net_bps_mean":-4.306675,"net_bps_med":-11.249231,"cum_logret":-0.039191,"end_equity":9615.672809,"max_drawdown":0.060348,"cagr":-0.019845},"score":8758.992657},"ml_sim":{"model_features":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","gap_tail","vol_z","dist_to_hi","range_ratio","tp_to_cost","entry_overnight"],"p_cut":0.562486,"edge_cut":0.00158,"valid":true,"train":{"n":83,"y_rate":0.578313,"net_bps_mean":13.506381,"net_bps_med":26.778901,"cum_logret":0.112103,"end_equity":11186.280345,"max_drawdown":0.105458,"cagr":0.014298},"test":{"n":38,"y_rate":0.631579,"net_bps_mean":27.110819,"net_bps_med":40.378198,"cum_logret":0.103021,"end_equity":11085.148131,"max_drawdown":0.033473,"cagr":0.054352},"score":10169.92256},"trial":13},"test_snapshot":{"n":38,"end_equity":11085.148131,"cagr":0.054352,"max_drawdown":0.033473,"calmar":1.623756,"net_bps_mean":27.110819}},"ml_by_calmar":{"mode":"ml_sim","selected_by":"end_equity","scenario":{"name":"spy_cross_off","symbols":["SPY","QQQ"],"trade_symbol":"SPY","cross_symbol":"QQQ","include_cross":false},"summary_path":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step2_out\\selection\\spy_cross_off\\step2b_summary.json","trial":{"filter_name":"no_overnight_sigma_50_85","knobs":{"trend_fast_span":10,"trend_slow_span":56,"trend_in":0.527552,"pullback_z":1.22888,"trend_regime_min":0.226767,"min_event_spacing_bars":1,"ewma_var_alpha":0.095507,"atr_span":24,"horizon_intra":12,"horizon_overn":10,"tp_mult_intra":2.427282,"sl_mult_intra":1.022804,"tp_mult_overn":2.906561,"sl_mult_overn":1.215725,"same_bar_policy":"worst","spread_half_bps":{"SPY":0.8,"QQQ":1.2,"SMH":1.8},"slip_base_bps":0.8,"slip_vol_mult":0.05,"slip_spike_add_bps":2.0,"vol_spike_q":0.9,"overnight_slip_add_bps":1.5,"commission_round_trip_bps":1.0,"gap_lookback_events":120,"gap_tail_k":2.0,"sigma_rank_window":500,"atr_rank_window":500,"rank_min_periods":200,"intraday_tail_window":200,"intraday_tail_min_periods":50,"intraday_tail_z":2.0,"include_cross_asset":false,"cross_symbol":"QQQ","cross_merge_tolerance":"30min","dropna_core_only":true},"n_bars":17654,"split_bar_idx":14123,"split_time_utc":"2024-02-06 14:30:00+00:00","base_counts":{"all_events":10630,"filtered_events":2146,"train_filtered":1650,"test_filtered":491},"no_ml":{"train":{"n":365,"y_rate":0.389041,"net_bps_mean":-5.124078,"net_bps_med":-22.64781,"cum_logret":-0.187029,"end_equity":8294.198105,"max_drawdown":0.187792,"cagr":-0.023377},"test":{"n":105,"y_rate":0.380952,"net_bps_mean":-3.272604,"net_bps_med":-29.860897,"cum_logret":-0.034362,"end_equity":9662.213431,"max_drawdown":0.077923,"cagr":-0.016907},"score":8835.248673},"ml_sim":{"model_features":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","gap_tail","vol_z","dist_to_hi","range_ratio","tp_to_cost","entry_overnight"],"p_cut":0.55241,"edge_cut":0.002546,"valid":true,"train":{"n":59,"y_rate":0.457627,"net_bps_mean":20.94867,"net_bps_med":-13.215872,"cum_logret":0.123597,"end_equity":11315.599305,"max_drawdown":0.041321,"cagr":0.016424},"test":{"n":34,"y_rate":0.558824,"net_bps_mean":24.07619,"net_bps_med":8.448818,"cum_logret":0.081859,"end_equity":10853.02821,"max_drawdown":0.021352,"cagr":0.04229},"score":10496.191695},"trial":12},"test_snapshot":{"n":34,"end_equity":10853.02821,"cagr":0.04229,"max_drawdown":0.021352,"calmar":1.980611,"net_bps_mean":24.07619}}}}