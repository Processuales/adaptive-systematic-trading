{"fold_id":"qqq_201912","symbol":"QQQ","test_start_utc":"2019-12-01 00:00:00+00:00","test_end_utc":"2020-01-01 00:00:00+00:00","n_train":468,"n_test":13,"n_trades_test":6,"policy_score_test":-0.01401337,"best_params":{"mix_struct_weight":0.55,"p_cut":0.46,"agg_p_cut":0.7,"safe_size":0.98,"aggressive_size":1.0,"ev_cut":-0.00056309,"agg_ev_cut":-0.00036309,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"base_params_before_drift_guard":{"mix_struct_weight":0.55,"p_cut":0.46,"agg_p_cut":0.7,"safe_size":0.98,"aggressive_size":1.0,"ev_cut":-0.00056309,"agg_ev_cut":-0.00036309,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"model_config":{"name":"tree_heavy","ridge_alpha_prob":6.0,"ridge_alpha_ret":8.0,"tree_weight_prob":0.75,"tree_weight_ret":0.8,"num_leaves":31,"learning_rate":0.05,"min_child_samples":28,"n_estimators":240},"ridge_prob_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","spy_age_min","spy_ema_fast_slope","spy_pullback_z","spy_range_ratio","spy_sigma","spy_trend_score","spy_u_atr","spy_vol_z","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"y","medians":{"H":12.0,"a_tp":0.00696232,"b_sl":0.00521514,"beta_proxy":1.14618521,"cost_rt":0.00077293,"dist_to_hi":-0.0040163,"ema_fast_slope":0.00040365,"entry_overnight":0.0,"gap_mu":0.00059462,"gap_sd":0.00543064,"gap_tail":7.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64710548,"range_ratio":0.00285052,"regime_agree":1.0,"ret_spread":0.00013053,"rs_log":-0.53955902,"same_bar_ambiguous":0.0,"sigma":0.00264873,"sigma_prank":0.304,"slip_half":0.00021647,"spread_half":0.00012,"spy_age_min":0.0,"spy_ema_fast_slope":0.00024266,"spy_pullback_z":0.55291317,"spy_range_ratio":0.00220515,"spy_sigma":0.00193949,"spy_trend_score":1.93324321,"spy_u_atr":0.00254404,"spy_vol_z":-0.41652962,"touch_delay_bars":6.0,"tp_to_cost":8.76244861,"trend_score":2.15267693,"truncated_horizon":0.0,"u_atr":0.00347676,"u_atr_prank":0.286,"vol_z":-0.31378355},"mu":[11.89949749,0.00767686,0.00574798,1.16826923,0.00082079,-0.00680033,0.0004219,0.05025126,0.00047167,0.00554798,6.51256281,7.24623116,0.06321726,0.54820372,0.00345074,0.87437186,9.977e-05,-0.54648824,0.00251256,0.00290636,0.35929101,0.00024039,0.00012,0.0,0.00028566,0.47808335,0.00259742,0.00223575,2.02298138,0.00294456,-0.3407707,7.07286432,9.18561456,2.3740175,0.0,0.0038191,0.35241213,-0.28486558],"sd":[0.43692593,0.00327583,0.00244718,0.14053413,0.00017132,0.0097697,0.00089278,0.21846297,0.00038252,0.00198857,4.51892647,3.92001351,0.01197683,1.05520525,0.00217371,0.3314298,0.00122567,0.06915491,0.05006246,0.00123276,0.27851229,8.566e-05,0.0,1.0,0.00068998,1.03628952,0.0018266,0.00104537,1.70421933,0.00141568,0.86332822,3.68171051,2.77536821,1.49790133,1.0,0.00162038,0.26267315,0.91506464],"beta":[0.51005025,-0.0068403,-0.07143319,-0.0705707,0.01798644,0.00221225,-0.04972078,0.07276463,0.0068403,-0.01194167,0.03164474,0.0532521,0.10776434,0.01433747,-0.0526018,-0.09408445,0.01306938,0.03492055,-0.01281413,-0.01959703,-0.00229913,0.05218832,0.00221225,0.0,0.0,-0.00739246,-0.02419587,0.08660559,-0.0957244,0.04274533,0.23237538,0.05298761,0.03649501,-0.03241305,-0.02737376,0.0,-0.06874619,-0.02430739,-0.01317581],"ridge_alpha":6.0},"ridge_ret_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","spy_age_min","spy_ema_fast_slope","spy_pullback_z","spy_range_ratio","spy_sigma","spy_trend_score","spy_u_atr","spy_vol_z","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"net_logret","medians":{"H":12.0,"a_tp":0.00696232,"b_sl":0.00521514,"beta_proxy":1.14618521,"cost_rt":0.00077293,"dist_to_hi":-0.0040163,"ema_fast_slope":0.00040365,"entry_overnight":0.0,"gap_mu":0.00059462,"gap_sd":0.00543064,"gap_tail":7.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64710548,"range_ratio":0.00285052,"regime_agree":1.0,"ret_spread":0.00013053,"rs_log":-0.53955902,"same_bar_ambiguous":0.0,"sigma":0.00264873,"sigma_prank":0.304,"slip_half":0.00021647,"spread_half":0.00012,"spy_age_min":0.0,"spy_ema_fast_slope":0.00024266,"spy_pullback_z":0.55291317,"spy_range_ratio":0.00220515,"spy_sigma":0.00193949,"spy_trend_score":1.93324321,"spy_u_atr":0.00254404,"spy_vol_z":-0.41652962,"touch_delay_bars":6.0,"tp_to_cost":8.76244861,"trend_score":2.15267693,"truncated_horizon":0.0,"u_atr":0.00347676,"u_atr_prank":0.286,"vol_z":-0.31378355},"mu":[11.89949749,0.00767686,0.00574798,1.16826923,0.00082079,-0.00680033,0.0004219,0.05025126,0.00047167,0.00554798,6.51256281,7.24623116,0.06321726,0.54820372,0.00345074,0.87437186,9.977e-05,-0.54648824,0.00251256,0.00290636,0.35929101,0.00024039,0.00012,0.0,0.00028566,0.47808335,0.00259742,0.00223575,2.02298138,0.00294456,-0.3407707,7.07286432,9.18561456,2.3740175,0.0,0.0038191,0.35241213,-0.28486558],"sd":[0.43692593,0.00327583,0.00244718,0.14053413,0.00017132,0.0097697,0.00089278,0.21846297,0.00038252,0.00198857,4.51892647,3.92001351,0.01197683,1.05520525,0.00217371,0.3314298,0.00122567,0.06915491,0.05006246,0.00123276,0.27851229,8.566e-05,0.0,1.0,0.00068998,1.03628952,0.0018266,0.00104537,1.70421933,0.00141568,0.86332822,3.68171051,2.77536821,1.49790133,1.0,0.00162038,0.26267315,0.91506464],"beta":[-0.00016222,-0.00016136,-0.00137622,-0.00144177,-5.716e-05,-8.399e-05,-0.00132652,0.00137481,0.00016136,-0.00029026,0.00033874,0.00112116,0.00038629,5.86e-06,-0.00063375,-0.00196849,0.00021997,0.00055157,-0.00046455,-0.00010052,0.00048405,0.00063531,-8.399e-05,0.0,0.0,0.00066936,-0.00102981,0.00144974,-0.00128632,0.00035713,0.00270797,0.00061199,0.00130583,0.00112104,-0.00054919,0.0,-0.00157263,-0.00049602,0.0001725],"ridge_alpha":8.0},"lgb_paths":{"classifier":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\qqq\\qqq_201912_lgb_cls.txt","regressor":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\qqq\\qqq_201912_lgb_ret.txt","quantile_q10":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\qqq\\qqq_201912_lgb_q10.txt","quantile_q90":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\qqq\\qqq_201912_lgb_q90.txt"},"probability_calibration":{"method":"isotonic","x_thresholds":[0.16794298,0.24655472,0.25350023,0.39300865,0.39698645,0.89001615],"y_thresholds":[0.45454545,0.45454545,0.5,0.5,0.51162791,0.51162791]},"confidence_calibration":{"method":"isotonic","x_thresholds":[0.0,0.06259898,0.07534031,0.22907046,0.24507325,0.40909091],"y_thresholds":[0.46153846,0.46153846,0.5,0.5,0.53333333,0.53333333]},"uncertainty_calibration":{"u_q25":0.01167269,"u_q75":0.01701855},"nested_tuning_rows":[{"cfg_name":"tree_heavy","inner_split":1,"score":7.70664153,"policy_score":7.91388569,"brier":0.25600588,"rmse":0.00761988,"n_val":67},{"cfg_name":"tree_heavy","inner_split":2,"score":1.29575433,"policy_score":1.51398569,"brier":0.26875742,"rmse":0.00833165,"n_val":67},{"cfg_name":"tree_stable","inner_split":1,"score":3.01141384,"policy_score":3.21244744,"brier":0.24712677,"rmse":0.00784426,"n_val":67},{"cfg_name":"tree_stable","inner_split":2,"score":0.90381241,"policy_score":1.12344841,"brier":0.27059909,"rmse":0.00834334,"n_val":67},{"cfg_name":"blend_conservative","inner_split":1,"score":1.9768596,"policy_score":2.18191452,"brier":0.25279688,"rmse":0.00772863,"n_val":67},{"cfg_name":"blend_conservative","inner_split":2,"score":0.88243417,"policy_score":1.10303672,"brier":0.27235598,"rmse":0.00816778,"n_val":67},{"selected_cfg":"tree_heavy","nested_score":4.50119793}],"drift":{"flag":false,"feature_drift":{"mean_abs_z":0.37139696,"max_abs_z":1.45107357,"top_shift_features":[{"feature":"rs_log","abs_z":1.45107357},{"feature":"gap_mu","abs_z":0.94759145},{"feature":"a_tp","abs_z":0.67691068},{"feature":"b_sl","abs_z":0.67563748},{"feature":"u_atr","abs_z":0.67225137}]},"performance_drift":{"mean_abs_z":0.37139696,"recent_median_net_bps":9.87604336,"recent_median_calmar":3.06927547}},"pattern_aid":{"enabled":true,"prob_strength":0.55,"ret_strength":0.65,"prob_max_abs_delta":0.04,"ret_max_abs_delta":0.0035,"selected_cols":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","intraday_tail_frac","range_ratio","ema_fast_slope","spy_sigma","spy_u_atr","spy_trend_score","spy_pullback_z","spy_range_ratio","spy_ema_fast_slope","rs_log","ret_spread","beta_proxy","regime_agree","entry_overnight"],"n_clusters":6,"global_win_rate":0.51005025,"global_ev":-0.00016222,"min_cluster_samples":40,"prior_strength":120.0,"consistency_tol":0.004,"cluster_rows":[{"cluster":0,"n":133,"win_rate_raw":0.47368421,"ev_raw":-0.00069778,"win_rate_shrunk":0.49093293,"ev_shrunk":-0.00044376,"ev_half_a":-0.00063372,"ev_half_b":-0.00083659,"consistency":0.94928278,"prob_delta":-0.01814775,"ev_delta":-0.00042125},{"cluster":1,"n":43,"win_rate_raw":0.53488372,"ev_raw":-0.00019857,"win_rate_shrunk":0.51660141,"ev_shrunk":-0.00017181,"ev_half_a":-0.00028993,"ev_half_b":-0.00015898,"consistency":0.96726191,"prob_delta":0.00633669,"ev_delta":-0.00016618},{"cluster":2,"n":66,"win_rate_raw":0.59090909,"ev_raw":0.0005312,"win_rate_shrunk":0.5387421,"ev_shrunk":8.383e-05,"ev_half_a":0.00074619,"ev_half_b":0.00027322,"consistency":0.88175625,"prob_delta":0.02529921,"ev_delta":7.392e-05},{"cluster":3,"n":77,"win_rate_raw":0.50649351,"ev_raw":0.00027218,"win_rate_shrunk":0.50866005,"ev_shrunk":7.57e-06,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":0.0},{"cluster":4,"n":47,"win_rate_raw":0.46808511,"ev_raw":-0.00025072,"win_rate_shrunk":0.4982397,"ev_shrunk":-0.00018713,"ev_half_a":0.00170767,"ev_half_b":-0.00486692,"consistency":0.0,"prob_delta":-0.0,"ev_delta":-0.0},{"cluster":5,"n":32,"win_rate_raw":0.53125,"ev_raw":-0.00023293,"win_rate_shrunk":0.51451336,"ev_shrunk":-0.00017711,"ev_half_a":-0.00212583,"ev_half_b":0.00123932,"consistency":0.03174228,"prob_delta":0.00014167,"ev_delta":-5.62e-06}]},"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","spy_age_min","spy_ema_fast_slope","spy_pullback_z","spy_range_ratio","spy_sigma","spy_trend_score","spy_u_atr","spy_vol_z","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"]}