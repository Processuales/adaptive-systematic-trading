{"fold_id":"spy_201912","symbol":"SPY","test_start_utc":"2019-12-01 00:00:00+00:00","test_end_utc":"2020-01-01 00:00:00+00:00","n_train":470,"n_test":13,"n_trades_test":4,"policy_score_test":-1e+18,"best_params":{"mix_struct_weight":0.55,"p_cut":0.46,"agg_p_cut":0.7,"safe_size":0.98,"aggressive_size":1.12,"ev_cut":-0.00065558,"agg_ev_cut":-0.00045558,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"base_params_before_drift_guard":{"mix_struct_weight":0.55,"p_cut":0.46,"agg_p_cut":0.7,"safe_size":0.98,"aggressive_size":1.12,"ev_cut":-0.00065558,"agg_ev_cut":-0.00045558,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"model_config":{"name":"tree_heavy","ridge_alpha_prob":6.0,"ridge_alpha_ret":8.0,"tree_weight_prob":0.75,"tree_weight_ret":0.8,"num_leaves":31,"learning_rate":0.05,"min_child_samples":28,"n_estimators":240},"ridge_prob_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"y","medians":{"H":12.0,"a_tp":0.005039,"b_sl":0.00377925,"beta_proxy":0.68165681,"cost_rt":0.00061877,"dist_to_hi":-0.00272432,"ema_fast_slope":0.00031357,"entry_overnight":0.0,"gap_mu":0.00035625,"gap_sd":0.00453032,"gap_tail":6.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64265023,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00039293,"qqq_pullback_z":0.6158366,"qqq_range_ratio":0.00293666,"qqq_sigma":0.00264519,"qqq_trend_score":2.26390579,"qqq_u_atr":0.00352184,"qqq_vol_z":-0.28460128,"range_ratio":0.00223829,"regime_agree":1.0,"ret_spread":-0.00016313,"rs_log":0.53787665,"same_bar_ambiguous":0.0,"sigma":0.00192944,"sigma_prank":0.282,"slip_half":0.00017939,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.00333689,"trend_score":2.17766745,"truncated_horizon":0.0,"u_atr":0.00251524,"u_atr_prank":0.298,"vol_z":-0.2897208},"mu":[11.88,0.00592382,0.00443537,0.65786389,0.0006817,-0.00527446,0.00031684,0.06,0.00032009,0.00439532,6.7,6.94,0.06065168,0.54646667,0.0,0.00038285,0.4944666,0.00362411,0.00297249,2.30833479,0.00393477,-0.21805362,0.00265339,0.8975,-2.272e-05,0.54591745,0.0,0.00222702,0.35884155,0.00021085,8e-05,6.7675,8.50352792,2.33551195,0.0,0.00294692,0.3593114,-0.23366738],"sd":[0.47497368,0.00294622,0.00220713,0.13438092,0.00016796,0.00861787,0.00069477,0.23748684,0.00030227,0.00160033,5.43092994,3.9219128,0.01070014,1.08047788,1.0,0.00093768,1.08124524,0.00220374,0.00130558,1.75475648,0.00175268,0.89426528,0.00175533,0.30330471,0.00147817,0.06871036,1.0,0.00107462,0.2981014,8.398e-05,1.0,3.6719809,3.00692706,1.45302143,1.0,0.00146907,0.28105231,0.85668181],"beta":[0.4925,-0.01688735,0.04082787,0.0479311,-0.04763544,-0.03374207,0.01545461,-0.04340853,0.01688735,-0.0014734,0.04370106,0.0778949,-0.07170902,-0.02200591,0.02319083,0.0,0.04503507,-0.06949249,0.02747847,0.01282737,0.00703514,-0.00678918,-0.03800644,-0.05924584,0.02963653,-0.04282534,0.04887398,0.0,-0.03788189,0.10096117,-0.03374207,0.0,0.13063969,-0.05439135,-0.01555569,0.0,0.06214307,-0.052515,0.05829507],"ridge_alpha":6.0},"ridge_ret_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"net_logret","medians":{"H":12.0,"a_tp":0.005039,"b_sl":0.00377925,"beta_proxy":0.68165681,"cost_rt":0.00061877,"dist_to_hi":-0.00272432,"ema_fast_slope":0.00031357,"entry_overnight":0.0,"gap_mu":0.00035625,"gap_sd":0.00453032,"gap_tail":6.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64265023,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00039293,"qqq_pullback_z":0.6158366,"qqq_range_ratio":0.00293666,"qqq_sigma":0.00264519,"qqq_trend_score":2.26390579,"qqq_u_atr":0.00352184,"qqq_vol_z":-0.28460128,"range_ratio":0.00223829,"regime_agree":1.0,"ret_spread":-0.00016313,"rs_log":0.53787665,"same_bar_ambiguous":0.0,"sigma":0.00192944,"sigma_prank":0.282,"slip_half":0.00017939,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.00333689,"trend_score":2.17766745,"truncated_horizon":0.0,"u_atr":0.00251524,"u_atr_prank":0.298,"vol_z":-0.2897208},"mu":[11.88,0.00592382,0.00443537,0.65786389,0.0006817,-0.00527446,0.00031684,0.06,0.00032009,0.00439532,6.7,6.94,0.06065168,0.54646667,0.0,0.00038285,0.4944666,0.00362411,0.00297249,2.30833479,0.00393477,-0.21805362,0.00265339,0.8975,-2.272e-05,0.54591745,0.0,0.00222702,0.35884155,0.00021085,8e-05,6.7675,8.50352792,2.33551195,0.0,0.00294692,0.3593114,-0.23366738],"sd":[0.47497368,0.00294622,0.00220713,0.13438092,0.00016796,0.00861787,0.00069477,0.23748684,0.00030227,0.00160033,5.43092994,3.9219128,0.01070014,1.08047788,1.0,0.00093768,1.08124524,0.00220374,0.00130558,1.75475648,0.00175268,0.89426528,0.00175533,0.30330471,0.00147817,0.06871036,1.0,0.00107462,0.2981014,8.398e-05,1.0,3.6719809,3.00692706,1.45302143,1.0,0.00146907,0.28105231,0.85668181],"beta":[-3.252e-05,0.00010383,0.0003559,0.00051673,-0.00056587,0.00021803,-0.00024117,0.00013615,-0.00010383,0.00037561,0.00060608,0.00081505,-0.00026974,-0.00029952,-0.00010793,0.0,0.0001769,-0.00057023,0.00040355,0.00032763,-0.00028712,-0.00140627,-0.00037336,0.00016721,0.00041424,-0.0006993,0.00058395,0.0,-0.00141116,0.00048913,0.00021803,0.0,0.00103289,-0.00033995,-0.0003197,0.0,0.00083891,-0.00069578,0.000471],"ridge_alpha":8.0},"lgb_paths":{"classifier":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_201912_lgb_cls.txt","regressor":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_201912_lgb_ret.txt","quantile_q10":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_201912_lgb_q10.txt","quantile_q90":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_201912_lgb_q90.txt"},"probability_calibration":{"method":"isotonic","x_thresholds":[0.19081991,0.24431305,0.255211,0.34508007,0.3490694,0.37997033,0.39263063,0.88547494],"y_thresholds":[0.0,0.0,0.16666667,0.16666667,0.33333333,0.33333333,0.57142857,0.57142857]},"confidence_calibration":{"method":"isotonic","x_thresholds":[0.09285714,0.99987],"y_thresholds":[0.44285714,0.44285714]},"uncertainty_calibration":{"u_q25":0.00834352,"u_q75":0.01281125},"nested_tuning_rows":[{"cfg_name":"tree_heavy","inner_split":1,"score":-1.76209596,"policy_score":-1.45608786,"brier":0.38913765,"rmse":0.00707743,"n_val":67},{"cfg_name":"tree_heavy","inner_split":2,"score":-1.7470501,"policy_score":-1.5200087,"brier":0.28469071,"rmse":0.00676168,"n_val":67},{"cfg_name":"tree_stable","inner_split":1,"score":-1.73877317,"policy_score":-1.45280124,"brier":0.36288831,"rmse":0.00690285,"n_val":67},{"cfg_name":"tree_stable","inner_split":2,"score":-2.33985704,"policy_score":-2.11333513,"brier":0.28418913,"rmse":0.00669004,"n_val":67},{"cfg_name":"blend_conservative","inner_split":1,"score":-1.83117881,"policy_score":-1.54197718,"brier":0.36668621,"rmse":0.00709348,"n_val":67},{"cfg_name":"blend_conservative","inner_split":2,"score":-2.3118787,"policy_score":-2.0820739,"brier":0.28878765,"rmse":0.00660703,"n_val":67},{"selected_cfg":"tree_heavy","nested_score":-1.75457303}],"drift":{"flag":false,"feature_drift":{"mean_abs_z":0.36024848,"max_abs_z":1.44971492,"top_shift_features":[{"feature":"rs_log","abs_z":1.44971492},{"feature":"gap_mu","abs_z":1.36758545},{"feature":"qqq_u_atr","abs_z":0.69603712},{"feature":"qqq_trend_score","abs_z":0.65750318},{"feature":"qqq_sigma","abs_z":0.58453204}]},"performance_drift":{"mean_abs_z":0.36024848,"recent_median_net_bps":17.28999877,"recent_median_calmar":8.21517333}},"pattern_aid":{"enabled":true,"prob_strength":0.55,"ret_strength":0.65,"prob_max_abs_delta":0.04,"ret_max_abs_delta":0.0035,"selected_cols":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","intraday_tail_frac","range_ratio","ema_fast_slope","rs_log","ret_spread","beta_proxy","regime_agree","entry_overnight"],"n_clusters":6,"global_win_rate":0.4925,"global_ev":-3.252e-05,"min_cluster_samples":40,"prior_strength":120.0,"consistency_tol":0.004,"cluster_rows":[{"cluster":0,"n":23,"win_rate_raw":0.60869565,"ev_raw":0.00104123,"win_rate_shrunk":0.51118881,"ev_shrunk":0.00014018,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":0.0,"ev_delta":0.0},{"cluster":1,"n":76,"win_rate_raw":0.46052632,"ev_raw":-1.641e-05,"win_rate_shrunk":0.48010204,"ev_shrunk":-2.627e-05,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":-0.0},{"cluster":2,"n":100,"win_rate_raw":0.41,"ev_raw":-0.00082374,"win_rate_shrunk":0.455,"ev_shrunk":-0.00039217,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":-0.0},{"cluster":3,"n":105,"win_rate_raw":0.53333333,"ev_raw":-1.014e-05,"win_rate_shrunk":0.51155556,"ev_shrunk":-2.208e-05,"ev_half_a":-0.00090831,"ev_half_b":0.00054257,"consistency":0.15931967,"prob_delta":0.00303592,"ev_delta":-3.52e-06},{"cluster":4,"n":42,"win_rate_raw":0.54761905,"ev_raw":0.0014372,"win_rate_shrunk":0.50679012,"ev_shrunk":0.00034852,"ev_half_a":0.0049072,"ev_half_b":-0.0009224,"consistency":0.0,"prob_delta":0.0,"ev_delta":0.0},{"cluster":5,"n":54,"win_rate_raw":0.51851852,"ev_raw":-0.00023395,"win_rate_shrunk":0.50057471,"ev_shrunk":-9.504e-05,"ev_half_a":-0.0007146,"ev_half_b":0.0003236,"consistency":0.18511213,"prob_delta":0.00149473,"ev_delta":-1.759e-05}]},"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"]}