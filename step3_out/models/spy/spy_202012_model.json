{"fold_id":"spy_202012","symbol":"SPY","test_start_utc":"2020-12-01 00:00:00+00:00","test_end_utc":"2021-01-01 00:00:00+00:00","n_train":504,"n_test":11,"n_trades_test":5,"policy_score_test":-1e+18,"best_params":{"mix_struct_weight":0.55,"p_cut":0.54,"agg_p_cut":0.58,"safe_size":0.65,"aggressive_size":1.0,"ev_cut":-0.00331528,"agg_ev_cut":-0.00311528,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"base_params_before_drift_guard":{"mix_struct_weight":0.55,"p_cut":0.54,"agg_p_cut":0.58,"safe_size":0.65,"aggressive_size":1.0,"ev_cut":-0.00331528,"agg_ev_cut":-0.00311528,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"model_config":{"name":"tree_heavy","ridge_alpha_prob":6.0,"ridge_alpha_ret":8.0,"tree_weight_prob":0.75,"tree_weight_ret":0.8,"num_leaves":31,"learning_rate":0.05,"min_child_samples":28,"n_estimators":240},"ridge_prob_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"y","medians":{"H":12.0,"a_tp":0.00504213,"b_sl":0.0037816,"beta_proxy":0.68460474,"cost_rt":0.00061429,"dist_to_hi":-0.00270054,"ema_fast_slope":0.00029664,"entry_overnight":0.0,"gap_mu":0.00039643,"gap_sd":0.0045935,"gap_tail":6.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64001468,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00040445,"qqq_pullback_z":0.60451571,"qqq_range_ratio":0.00302564,"qqq_sigma":0.00266614,"qqq_trend_score":2.29793234,"qqq_u_atr":0.00354271,"qqq_vol_z":-0.30857364,"range_ratio":0.00227305,"regime_agree":1.0,"ret_spread":-8.93e-05,"rs_log":0.47646911,"same_bar_ambiguous":0.0,"sigma":0.00188848,"sigma_prank":0.352,"slip_half":0.00017714,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.00753634,"trend_score":2.25381704,"truncated_horizon":0.0,"u_atr":0.00251819,"u_atr_prank":0.36,"vol_z":-0.30803132},"mu":[11.8974359,0.0063158,0.00473003,0.66518953,0.00069966,-0.00618839,0.00034501,0.05128205,0.00036647,0.00483736,8.10722611,6.95571096,0.06024476,0.55278935,0.0,0.00042648,0.53065412,0.00371257,0.0031984,2.39177514,0.00411491,-0.22649188,0.00276913,0.91608392,-4.766e-05,0.48674434,0.0,0.00245632,0.3853986,0.00021983,8e-05,6.79254079,8.51737112,2.38477918,0.0,0.00314426,0.39401865,-0.23071586],"sd":[0.44114489,0.00468811,0.0035147,0.14002767,0.00023673,0.01397866,0.00089198,0.22057244,0.00049891,0.00333433,5.05011426,3.93127396,0.01071992,1.09501509,1.0,0.00105457,1.09058905,0.0023184,0.00195526,1.70658399,0.0022529,0.91954898,0.00212677,0.27726192,0.00145484,0.0716588,1.0,0.00203835,0.29270111,0.00011837,1.0,3.69417614,2.72529843,1.40729193,1.0,0.0023419,0.27915336,0.86585036],"beta":[0.4988345,-0.03475069,0.0464421,0.0513434,-0.01093668,-0.03018231,0.03445256,-0.08906292,0.03475069,-0.00606359,0.02047684,0.08108418,-0.04703691,-0.01858321,0.04885846,0.0,0.06337049,-0.07794523,0.01438219,-0.08149619,-0.04375584,0.00973489,-0.07410067,-0.09088686,0.03214652,-0.04325137,-0.02085549,0.0,0.0278857,-0.05872159,-0.03018231,0.0,0.13546245,-0.0711644,-0.01510917,0.0,0.06114137,0.09772112,0.07018196],"ridge_alpha":6.0},"ridge_ret_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"net_logret","medians":{"H":12.0,"a_tp":0.00504213,"b_sl":0.0037816,"beta_proxy":0.68460474,"cost_rt":0.00061429,"dist_to_hi":-0.00270054,"ema_fast_slope":0.00029664,"entry_overnight":0.0,"gap_mu":0.00039643,"gap_sd":0.0045935,"gap_tail":6.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64001468,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00040445,"qqq_pullback_z":0.60451571,"qqq_range_ratio":0.00302564,"qqq_sigma":0.00266614,"qqq_trend_score":2.29793234,"qqq_u_atr":0.00354271,"qqq_vol_z":-0.30857364,"range_ratio":0.00227305,"regime_agree":1.0,"ret_spread":-8.93e-05,"rs_log":0.47646911,"same_bar_ambiguous":0.0,"sigma":0.00188848,"sigma_prank":0.352,"slip_half":0.00017714,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.00753634,"trend_score":2.25381704,"truncated_horizon":0.0,"u_atr":0.00251819,"u_atr_prank":0.36,"vol_z":-0.30803132},"mu":[11.8974359,0.0063158,0.00473003,0.66518953,0.00069966,-0.00618839,0.00034501,0.05128205,0.00036647,0.00483736,8.10722611,6.95571096,0.06024476,0.55278935,0.0,0.00042648,0.53065412,0.00371257,0.0031984,2.39177514,0.00411491,-0.22649188,0.00276913,0.91608392,-4.766e-05,0.48674434,0.0,0.00245632,0.3853986,0.00021983,8e-05,6.79254079,8.51737112,2.38477918,0.0,0.00314426,0.39401865,-0.23071586],"sd":[0.44114489,0.00468811,0.0035147,0.14002767,0.00023673,0.01397866,0.00089198,0.22057244,0.00049891,0.00333433,5.05011426,3.93127396,0.01071992,1.09501509,1.0,0.00105457,1.09058905,0.0023184,0.00195526,1.70658399,0.0022529,0.91954898,0.00212677,0.27726192,0.00145484,0.0716588,1.0,0.00203835,0.29270111,0.00011837,1.0,3.69417614,2.72529843,1.40729193,1.0,0.0023419,0.27915336,0.86585036],"beta":[0.00028698,-0.00016463,0.00040493,0.00044542,0.00017592,0.00020669,0.00130951,-0.00215976,0.00016463,-0.00070552,0.00044515,0.00107081,-0.00012372,-0.00032536,0.00072817,0.0,0.00117698,-0.00086429,0.00028325,4.441e-05,-0.00067223,-0.00234058,-0.00133952,-0.00059091,9.792e-05,-0.00059414,-0.00034203,0.0,0.00096499,-0.00117004,0.00020669,0.0,0.00110875,-0.00072939,-0.00044001,0.0,0.00052635,0.00164414,0.00097613],"ridge_alpha":8.0},"lgb_paths":{"classifier":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202012_lgb_cls.txt","regressor":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202012_lgb_ret.txt","quantile_q10":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202012_lgb_q10.txt","quantile_q90":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202012_lgb_q90.txt"},"probability_calibration":{"method":"isotonic","x_thresholds":[0.15300355,0.16416305,0.20043953,0.20865969,0.32317312,0.32701136,0.4748455,0.47983754,0.48068488,0.48230796,0.80918474,0.80944655,0.81992528,0.84040995,0.89893365],"y_thresholds":[0.0,0.25,0.25,0.29411765,0.29411765,0.44444444,0.44444444,0.5,0.5,0.54545455,0.54545455,0.66666667,0.66666667,1.0,1.0]},"confidence_calibration":{"method":"isotonic","x_thresholds":[0.05909091,0.06925864,0.07222222,0.504255,0.51223651,0.59625152,0.61764706,0.675,0.82033234,0.99987],"y_thresholds":[0.42857143,0.42857143,0.45,0.45,0.5,0.5,0.6,0.6,0.8,0.8]},"uncertainty_calibration":{"u_q25":0.02224766,"u_q75":0.03549128},"nested_tuning_rows":[{"cfg_name":"tree_heavy","inner_split":1,"score":4.77707251,"policy_score":4.99723528,"brier":0.27286008,"rmse":0.00775885,"n_val":72},{"cfg_name":"tree_heavy","inner_split":2,"score":0.04227664,"policy_score":0.26258292,"brier":0.27640868,"rmse":0.00649989,"n_val":72},{"cfg_name":"tree_stable","inner_split":1,"score":0.90668603,"policy_score":1.11912799,"brier":0.26286678,"rmse":0.00764594,"n_val":72},{"cfg_name":"tree_stable","inner_split":2,"score":-0.55559629,"policy_score":-0.32596337,"brier":0.2894147,"rmse":0.00628595,"n_val":72},{"cfg_name":"blend_conservative","inner_split":1,"score":-1.01242084,"policy_score":-0.78769956,"brier":0.27951813,"rmse":0.00754134,"n_val":72},{"cfg_name":"blend_conservative","inner_split":2,"score":0.61603081,"policy_score":0.85024577,"brier":0.29611898,"rmse":0.00606287,"n_val":72},{"selected_cfg":"tree_heavy","nested_score":2.40967457}],"drift":{"flag":false,"feature_drift":{"mean_abs_z":0.30542751,"max_abs_z":2.21370293,"top_shift_features":[{"feature":"rs_log","abs_z":2.21370293},{"feature":"gap_mu","abs_z":1.90265052},{"feature":"gap_tail","abs_z":1.16114457},{"feature":"spread_half","abs_z":1.0},{"feature":"u_atr_prank","abs_z":0.92909693}]},"performance_drift":{"mean_abs_z":0.30542751,"recent_median_net_bps":65.80899515,"recent_median_calmar":18.88936282}},"pattern_aid":{"enabled":true,"prob_strength":0.55,"ret_strength":0.65,"prob_max_abs_delta":0.04,"ret_max_abs_delta":0.0035,"selected_cols":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","intraday_tail_frac","range_ratio","ema_fast_slope","rs_log","ret_spread","beta_proxy","regime_agree","entry_overnight"],"n_clusters":6,"global_win_rate":0.4988345,"global_ev":0.00028698,"min_cluster_samples":40,"prior_strength":120.0,"consistency_tol":0.004,"cluster_rows":[{"cluster":0,"n":22,"win_rate_raw":0.77272727,"ev_raw":0.00225338,"win_rate_shrunk":0.54126859,"ev_shrunk":0.00059164,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":0.0,"ev_delta":0.0},{"cluster":1,"n":16,"win_rate_raw":0.5625,"ev_raw":0.00514775,"win_rate_shrunk":0.50632456,"ev_shrunk":0.00085884,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":0.0,"ev_delta":0.0},{"cluster":2,"n":111,"win_rate_raw":0.51351351,"ev_raw":0.00016539,"win_rate_shrunk":0.50588805,"ev_shrunk":0.00022856,"ev_half_a":0.00057621,"ev_half_b":-0.00030072,"consistency":0.19519215,"prob_delta":0.0013768,"ev_delta":4.461e-05},{"cluster":3,"n":33,"win_rate_raw":0.45454545,"ev_raw":-0.00018607,"win_rate_shrunk":0.48928196,"ev_shrunk":0.00018495,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":0.0},{"cluster":4,"n":152,"win_rate_raw":0.42105263,"ev_raw":-0.000637,"win_rate_shrunk":0.45536816,"ev_shrunk":-0.00022936,"ev_half_a":-0.00077347,"ev_half_b":-0.00048536,"consistency":0.92797347,"prob_delta":-0.04033561,"ev_delta":-0.00021284},{"cluster":5,"n":95,"win_rate_raw":0.54736842,"ev_raw":0.00079772,"win_rate_shrunk":0.52027972,"ev_shrunk":0.00051266,"ev_half_a":0.00042738,"ev_half_b":0.00103397,"consistency":0.84835242,"prob_delta":0.01819311,"ev_delta":0.00043491}]},"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"]}