{"fold_id":"spy_202101","symbol":"SPY","test_start_utc":"2021-01-01 00:00:00+00:00","test_end_utc":"2021-02-01 00:00:00+00:00","n_train":502,"n_test":9,"n_trades_test":7,"policy_score_test":-4.98113524,"best_params":{"mix_struct_weight":0.55,"p_cut":0.54,"agg_p_cut":0.58,"safe_size":0.65,"aggressive_size":1.0,"ev_cut":-0.00331528,"agg_ev_cut":-0.00311528,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"base_params_before_drift_guard":{"mix_struct_weight":0.55,"p_cut":0.54,"agg_p_cut":0.58,"safe_size":0.65,"aggressive_size":1.0,"ev_cut":-0.00331528,"agg_ev_cut":-0.00311528,"use_confidence_sizing":true,"safe_size_floor_mult":0.7,"safe_size_ceiling_mult":1.22,"agg_size_floor_mult":0.8,"agg_size_ceiling_mult":1.28,"max_aggressive_size":1.35},"model_config":{"name":"tree_heavy","ridge_alpha_prob":6.0,"ridge_alpha_ret":8.0,"tree_weight_prob":0.75,"tree_weight_ret":0.8,"num_leaves":31,"learning_rate":0.05,"min_child_samples":28,"n_estimators":240},"ridge_prob_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"y","medians":{"H":12.0,"a_tp":0.00512516,"b_sl":0.00384035,"beta_proxy":0.69415226,"cost_rt":0.0006191,"dist_to_hi":-0.00282431,"ema_fast_slope":0.00030579,"entry_overnight":0.0,"gap_mu":0.00039439,"gap_sd":0.00461361,"gap_tail":7.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64001468,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00040706,"qqq_pullback_z":0.62014574,"qqq_range_ratio":0.00312136,"qqq_sigma":0.00273934,"qqq_trend_score":2.29793234,"qqq_u_atr":0.00358237,"qqq_vol_z":-0.33091174,"range_ratio":0.00232632,"regime_agree":1.0,"ret_spread":-4.384e-05,"rs_log":0.4738022,"same_bar_ambiguous":0.0,"sigma":0.00194212,"sigma_prank":0.356,"slip_half":0.00017955,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.07733201,"trend_score":2.244305,"truncated_horizon":0.0,"u_atr":0.00255195,"u_atr_prank":0.362,"vol_z":-0.34430909},"mu":[11.8969555,0.00657217,0.00492176,0.67646026,0.00071189,-0.00643139,0.00035418,0.05152225,0.0003177,0.00530501,8.59953162,6.96252927,0.06064403,0.54105246,0.0,0.00043388,0.52911937,0.0038116,0.00329601,2.41214723,0.00422554,-0.23685461,0.00286714,0.92271663,8.39e-06,0.4758073,0.0,0.00257694,0.38893677,0.00022594,8e-05,6.79625293,8.671061,2.34071334,0.0,0.00327135,0.39576581,-0.24261586],"sd":[0.44212083,0.0048517,0.0036365,0.14544419,0.00024349,0.01414656,0.00095565,0.22106041,0.00058271,0.00430307,5.25698374,3.93429659,0.01047445,1.1026411,1.0,0.00108942,1.09567448,0.00250225,0.00201661,1.68147487,0.00232067,0.92809168,0.00226113,0.26704055,0.00148266,0.0754063,1.0,0.00212291,0.29091355,0.00012175,1.0,3.69291809,2.81952799,1.37929932,1.0,0.00242203,0.27642129,0.87535752],"beta":[0.4941452,-0.03804158,0.07309448,0.08056732,-0.02135834,-0.02401695,0.05675646,-0.07518472,0.03804158,-0.03264647,-0.09792812,0.08899429,-0.05013769,-0.01432431,0.02894287,0.0,0.04123783,-0.05699018,-0.01371814,-0.10794178,-0.04205225,0.0100079,-0.05945667,-0.08856198,0.03879236,-0.04260242,-0.05829409,0.0,0.02615552,-0.07525919,-0.02401695,0.0,0.1490577,-0.06664381,-0.02536105,0.0,0.09551255,0.0921735,0.05519185],"ridge_alpha":6.0},"ridge_ret_model":{"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"],"target_col":"net_logret","medians":{"H":12.0,"a_tp":0.00512516,"b_sl":0.00384035,"beta_proxy":0.69415226,"cost_rt":0.0006191,"dist_to_hi":-0.00282431,"ema_fast_slope":0.00030579,"entry_overnight":0.0,"gap_mu":0.00039439,"gap_sd":0.00461361,"gap_tail":7.0,"hold_bars":6.0,"intraday_tail_frac":0.06,"pullback_z":0.64001468,"qqq_age_min":0.0,"qqq_ema_fast_slope":0.00040706,"qqq_pullback_z":0.62014574,"qqq_range_ratio":0.00312136,"qqq_sigma":0.00273934,"qqq_trend_score":2.29793234,"qqq_u_atr":0.00358237,"qqq_vol_z":-0.33091174,"range_ratio":0.00232632,"regime_agree":1.0,"ret_spread":-4.384e-05,"rs_log":0.4738022,"same_bar_ambiguous":0.0,"sigma":0.00194212,"sigma_prank":0.356,"slip_half":0.00017955,"spread_half":8e-05,"touch_delay_bars":6.0,"tp_to_cost":8.07733201,"trend_score":2.244305,"truncated_horizon":0.0,"u_atr":0.00255195,"u_atr_prank":0.362,"vol_z":-0.34430909},"mu":[11.8969555,0.00657217,0.00492176,0.67646026,0.00071189,-0.00643139,0.00035418,0.05152225,0.0003177,0.00530501,8.59953162,6.96252927,0.06064403,0.54105246,0.0,0.00043388,0.52911937,0.0038116,0.00329601,2.41214723,0.00422554,-0.23685461,0.00286714,0.92271663,8.39e-06,0.4758073,0.0,0.00257694,0.38893677,0.00022594,8e-05,6.79625293,8.671061,2.34071334,0.0,0.00327135,0.39576581,-0.24261586],"sd":[0.44212083,0.0048517,0.0036365,0.14544419,0.00024349,0.01414656,0.00095565,0.22106041,0.00058271,0.00430307,5.25698374,3.93429659,0.01047445,1.1026411,1.0,0.00108942,1.09567448,0.00250225,0.00201661,1.68147487,0.00232067,0.92809168,0.00226113,0.26704055,0.00148266,0.0754063,1.0,0.00212291,0.29091355,0.00012175,1.0,3.69291809,2.81952799,1.37929932,1.0,0.00242203,0.27642129,0.87535752],"beta":[0.00020586,-0.0001189,0.00094912,0.00106714,5.634e-05,0.00025178,0.00181187,-0.00181591,0.0001189,-0.00081819,-0.00176412,0.00106401,-0.00023407,-0.00026348,0.00047676,0.0,0.00068499,-0.00070296,-0.00022219,-0.00035319,-0.00075519,-0.00215707,-0.001084,-0.00086395,0.00023105,-0.00079637,-0.00069798,0.0,0.00147281,-0.00156253,0.00025178,0.0,0.00139208,-0.0007675,-0.00046131,0.0,0.00130323,0.00147823,0.00083141],"ridge_alpha":8.0},"lgb_paths":{"classifier":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202101_lgb_cls.txt","regressor":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202101_lgb_ret.txt","quantile_q10":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202101_lgb_q10.txt","quantile_q90":"C:\\dev\\Coding\\Trading Bot\\adaptive-systematic-trading\\step3_out\\models\\spy\\spy_202101_lgb_q90.txt"},"probability_calibration":{"method":"isotonic","x_thresholds":[0.12872115,0.13356604,0.18532307,0.19663326,0.33631712,0.34004755,0.38292963,0.39192584,0.54237261,0.56470876,0.80240597,0.81295836,0.88755512],"y_thresholds":[0.0,0.2,0.2,0.29411765,0.29411765,0.5,0.5,0.61111111,0.61111111,0.61538462,0.61538462,1.0,1.0]},"confidence_calibration":{"method":"isotonic","x_thresholds":[0.0,0.58488076,0.61764706,0.74,0.84798995,0.99987],"y_thresholds":[0.45283019,0.45283019,0.5,0.5,1.0,1.0]},"uncertainty_calibration":{"u_q25":0.01521254,"u_q75":0.02648251},"nested_tuning_rows":[],"drift":{"flag":false,"feature_drift":{"mean_abs_z":0.37955035,"max_abs_z":2.13498111,"top_shift_features":[{"feature":"rs_log","abs_z":2.13498111},{"feature":"gap_mu","abs_z":1.5200268},{"feature":"gap_tail","abs_z":1.16200122},{"feature":"spread_half","abs_z":1.0},{"feature":"tp_to_cost","abs_z":0.8098737}]},"performance_drift":{"mean_abs_z":0.37955035,"recent_median_net_bps":52.49992474,"recent_median_calmar":10.9351084}},"pattern_aid":{"enabled":true,"prob_strength":0.55,"ret_strength":0.65,"prob_max_abs_delta":0.04,"ret_max_abs_delta":0.0035,"selected_cols":["trend_score","pullback_z","sigma","u_atr","sigma_prank","u_atr_prank","gap_sd","intraday_tail_frac","range_ratio","ema_fast_slope","rs_log","ret_spread","beta_proxy","regime_agree","entry_overnight"],"n_clusters":6,"global_win_rate":0.4941452,"global_ev":0.00020586,"min_cluster_samples":40,"prior_strength":120.0,"consistency_tol":0.004,"cluster_rows":[{"cluster":0,"n":21,"win_rate_raw":0.80952381,"ev_raw":0.00258086,"win_rate_shrunk":0.54111648,"ev_shrunk":0.00055959,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":0.0,"ev_delta":0.0},{"cluster":1,"n":161,"win_rate_raw":0.43478261,"ev_raw":-0.00044644,"win_rate_shrunk":0.46013318,"ev_shrunk":-0.00016787,"ev_half_a":-0.00071026,"ev_half_b":-0.0001657,"consistency":0.86385852,"prob_delta":-0.02938157,"ev_delta":-0.00014502},{"cluster":2,"n":109,"win_rate_raw":0.5412844,"ev_raw":0.00062673,"win_rate_shrunk":0.51658264,"ev_shrunk":0.00040619,"ev_half_a":0.00102762,"ev_half_b":0.00015368,"consistency":0.78151515,"prob_delta":0.0175352,"ev_delta":0.00031744},{"cluster":3,"n":78,"win_rate_raw":0.5,"ev_raw":3.097e-05,"win_rate_shrunk":0.49645164,"ev_shrunk":0.00013696,"ev_half_a":-0.00093413,"ev_half_b":0.0007387,"consistency":0.14544808,"prob_delta":0.00033547,"ev_delta":1.992e-05},{"cluster":4,"n":28,"win_rate_raw":0.46428571,"ev_raw":0.00152325,"win_rate_shrunk":0.48849611,"ev_shrunk":0.0004551,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":0.0},{"cluster":5,"n":30,"win_rate_raw":0.43333333,"ev_raw":-0.00025994,"win_rate_shrunk":0.48198283,"ev_shrunk":0.0001127,"ev_half_a":0.0,"ev_half_b":0.0,"consistency":0.0,"prob_delta":-0.0,"ev_delta":0.0}]},"feature_cols":["H","a_tp","b_sl","beta_proxy","cost_rt","dist_to_hi","ema_fast_slope","entry_overnight","gap_mu","gap_sd","gap_tail","hold_bars","intraday_tail_frac","pullback_z","qqq_age_min","qqq_ema_fast_slope","qqq_pullback_z","qqq_range_ratio","qqq_sigma","qqq_trend_score","qqq_u_atr","qqq_vol_z","range_ratio","regime_agree","ret_spread","rs_log","same_bar_ambiguous","sigma","sigma_prank","slip_half","spread_half","touch_delay_bars","tp_to_cost","trend_score","truncated_horizon","u_atr","u_atr_prank","vol_z"]}